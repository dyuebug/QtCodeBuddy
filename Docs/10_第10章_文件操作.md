# 第10章：文件操作

## 一、本章概述

### 1.1 学习目标

- 掌握 QFile 文件读写
- 学会使用 QTextStream 处理文本
- 理解 QDataStream 二进制流
- 掌握 QDir 目录操作

### 1.2 核心知识点

| 知识点 | 重要程度 | 说明 |
|--------|----------|------|
| QFile | ★★★★★ | 文件读写 |
| QTextStream | ★★★★★ | 文本流 |
| QDataStream | ★★★★☆ | 二进制流 |
| QDir | ★★★★☆ | 目录操作 |
| QFileInfo | ★★★☆☆ | 文件信息 |

---

## 二、QFile 文件操作

### 2.1 打开模式

```cpp
QFile file("test.txt");

// 只读
file.open(QIODevice::ReadOnly);

// 只写（覆盖）
file.open(QIODevice::WriteOnly);

// 追加
file.open(QIODevice::Append);

// 读写
file.open(QIODevice::ReadWrite);

// 文本模式（自动处理换行符）
file.open(QIODevice::ReadOnly | QIODevice::Text);
```

---

## 三、QTextStream 文本流

### 3.1 写入文本

```cpp
QFile file("test.txt");
if (file.open(QIODevice::WriteOnly | QIODevice::Text)) {
    QTextStream out(&file);
    out.setEncoding(QStringConverter::Utf8);
    out << "Hello, Qt6!" << "\n";
    file.close();
}
```

### 3.2 读取文本

```cpp
QFile file("test.txt");
if (file.open(QIODevice::ReadOnly | QIODevice::Text)) {
    QTextStream in(&file);
    QString content = in.readAll();
    file.close();
}
```

---

## 四、QDataStream 二进制流

```cpp
// 写入
QFile file("data.bin");
if (file.open(QIODevice::WriteOnly)) {
    QDataStream out(&file);
    out.setVersion(QDataStream::Qt_6_0);
    out << QString("张三") << 25;
    file.close();
}

// 读取
if (file.open(QIODevice::ReadOnly)) {
    QDataStream in(&file);
    in.setVersion(QDataStream::Qt_6_0);
    QString name;
    int age;
    in >> name >> age;
    file.close();
}
```

---

## 五、QDir 目录操作

```cpp
QDir dir("/path/to/dir");

// 创建目录
dir.mkdir("newFolder");

// 列出文件
QFileInfoList files = dir.entryInfoList(QDir::Files);

// 判断存在
if (dir.exists()) { }
```

---

## 六、本章小结

| 类 | 用途 |
|------|------|
| QFile | 文件读写 |
| QTextStream | 文本流处理 |
| QDataStream | 二进制流处理 |
| QDir | 目录操作 |
| QFileInfo | 获取文件信息 |
